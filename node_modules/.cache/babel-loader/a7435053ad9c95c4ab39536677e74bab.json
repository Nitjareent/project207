{"ast":null,"code":"import _defineProperty from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/spideypepo/207comlab/lec7React/lec7/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import'bulma/css/bulma.css';import firebase from'../firebase/firebase';import Navbar from'./Navbar';import MessageList from'../components/MessageList';var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);function Login(props){var _this$state2;var _this;_classCallCheck(this,Login);_this=_possibleConstructorReturn(this,_getPrototypeOf(Login).call(this,props));_this.post=function(e){firebase.firestore().collection('users').doc(_this.state.currentUser.email).collection('messages').add({text:_this.state.comment,timestamp:new Date()});};_this.delete=function(e){firebase.firestore().collection('users').doc(_this.state.currentUser.email).collection('messages').doc(e.target.value).delete();};_this.onChange=function(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;_this.setState(_defineProperty({},name,value));};_this.onSubmit=function(e){e.preventDefault();var _this$state=_this.state,email=_this$state.email,password=_this$state.password;firebase.auth().signInWithEmailAndPassword(email,password).then(function(response){_this.setState({currentUser:response.user});}).catch(function(error){_this.setState({message:error.message});});};_this.state=(_this$state2={email:'',password:'',messages:''},_defineProperty(_this$state2,\"messages\",[]),_defineProperty(_this$state2,\"currentUser\",null),_defineProperty(_this$state2,\"image\",''),_defineProperty(_this$state2,\"comment\",''),_this$state2);_this.logout=_this.logout.bind(_assertThisInitialized(_this));return _this;}_createClass(Login,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;firebase.auth().onAuthStateChanged(function(user){if(user){_this2.setState({currentUser:user});firebase.firestore().collection('users').doc(user.email).collection('messages').onSnapshot(function(item){_this2.setState({messages:item});});firebase.storage().ref('40510726_1885325624882038_6625989121489764352_n.jpg').getDownloadURL().then(function(response){return _this2.setState({image:response});});}});}},{key:\"logout\",value:function logout(){var _this3=this;firebase.auth().signOut().then(function(response){_this3.setState({currentUser:null});});}},{key:\"render\",value:function render(){var _this$state3=this.state,message=_this$state3.message,currentUser=_this$state3.currentUser;if(currentUser){return React.createElement(\"div\",null,React.createElement(Navbar,{logout:this.logout,username:currentUser.email}),React.createElement(MessageList,{image:this.state.image,messages:this.state.messages,onChange:this.onChange,post:this.post,delete:this.delete}));}return React.createElement(\"section\",{className:\"section container\"},React.createElement(\"div\",{className:\"columns is-centered\"},React.createElement(\"div\",{className:\"column is-half\"},React.createElement(\"form\",{onSubmit:this.onSubmit},React.createElement(\"div\",{className:\"field\"},React.createElement(\"label\",{className:\"label\"},\"Email\"),React.createElement(\"div\",{className:\"control\"},React.createElement(\"input\",{className:\"input\",type:\"email\",name:\"email\",onChange:this.onChange}))),React.createElement(\"div\",{className:\"field\"},React.createElement(\"label\",{className:\"label\"},\"password\"),React.createElement(\"div\",{className:\"control\"},React.createElement(\"input\",{className:\"input\",type:\"password\",name:\"password\",onChange:this.onChange}))),message?React.createElement(\"p\",{className:\"help is-danger\"},message):null,React.createElement(\"div\",{className:\"field is-grouped\"},React.createElement(\"div\",{className:\"control\"},React.createElement(\"button\",{className:\"button is-link\"},\"Login\")))))));}}]);return Login;}(React.Component);export default Login;","map":{"version":3,"sources":["/Users/spideypepo/207comlab/lec7React/lec7/src/components/Login.jsx"],"names":["React","firebase","Navbar","MessageList","Login","props","post","e","firestore","collection","doc","state","currentUser","email","add","text","comment","timestamp","Date","delete","target","value","onChange","name","setState","onSubmit","preventDefault","password","auth","signInWithEmailAndPassword","then","response","user","catch","error","message","messages","logout","bind","onAuthStateChanged","onSnapshot","item","storage","ref","getDownloadURL","image","signOut","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport 'bulma/css/bulma.css'\nimport firebase from '../firebase/firebase'\nimport Navbar from './Navbar'\nimport MessageList from '../components/MessageList'\n\n\nclass Login extends React.Component{\n    constructor(props){\n        super(props)\n\n        this.state ={\n            email: '',\n            password: '',\n            messages: '',\n            messages: [],\n            currentUser: null,\n            image: '',\n            comment: ''\n        }\n        this.logout = this.logout.bind(this)\n    }\n\n    componentDidMount(){\n        firebase.auth().onAuthStateChanged(user => {\n            if(user){\n                this.setState({\n                    currentUser: user\n                })\n                firebase.firestore().collection('users')\n                .doc(user.email)\n                .collection('messages')\n                .onSnapshot(item =>{\n                    this.setState({\n                        messages: item\n                    })\n                })\n                firebase.storage().ref('40510726_1885325624882038_6625989121489764352_n.jpg')\n                .getDownloadURL().then(response => this.setState({image: response}))\n            }\n        })\n    }\n\n    post = e => {\n        firebase.firestore()\n        .collection('users')\n        .doc(this.state.currentUser.email)\n        .collection('messages')\n        .add({\n            text: this.state.comment,\n            timestamp: new Date()\n        })\n\n    }\n\n    delete = e => {\n        firebase.firestore()\n        .collection('users')\n        .doc(this.state.currentUser.email)\n        .collection('messages')\n        .doc(e.target.value)\n        .delete()\n    }\n\n    onChange = e => {\n        const { name,value} = e.target\n        this.setState({\n            [name]: value\n        })\n    }\n\n    onSubmit = e => {\n        e.preventDefault()\n        const { email,password } = this.state\n        firebase.auth()\n           .signInWithEmailAndPassword(email, password)\n           .then(response => {\n               this.setState({\n                   currentUser: response.user\n               })\n           })\n           .catch(error => {\n               this.setState({\n                   message: error.message\n               })\n           })\n\n\n    }\n\n    logout(){\n        firebase.auth().signOut().then(response => {\n            this.setState({\n                currentUser: null\n            })\n        })\n    }\n\n    render(){\n        const { message, currentUser } = this.state\n        if (currentUser){\n            return(\n                <div>\n                    <Navbar logout={this.logout} username={currentUser.email}></Navbar>\n                    <MessageList\n                       image={this.state.image}\n                       messages={this.state.messages}\n                       onChange={this.onChange}\n                       post={this.post}\n                       delete={this.delete} />\n                </div>\n            )\n        }\n        return(\n            <section className=\"section container\">\n               <div className=\"columns is-centered\">\n                   <div className=\"column is-half\">\n                       <form onSubmit={this.onSubmit}> \n                           <div className=\"field\">\n                               <label className=\"label\">Email</label>\n                               <div className=\"control\">\n                                   <input className=\"input\" type=\"email\" name=\"email\" onChange={this.onChange} />\n                               </div>\n                           </div>\n                           <div className=\"field\">\n                               <label className=\"label\">\n                                   password\n                               </label>\n                               <div className=\"control\">\n                                   <input className=\"input\" type=\"password\" name=\"password\" onChange={this.onChange} />\n                               </div>\n                           </div>\n                                {message ? <p className=\"help is-danger\">{message}</p> : null}\n                           <div className=\"field is-grouped\">\n                               <div className=\"control\">\n                                   <button className=\"button is-link\">Login</button>\n                               </div>\n                           </div>\n                       </form>\n                   </div>\n               </div>\n           </section>\n\n        )\n    }\n}\n\nexport default Login"]},"metadata":{},"sourceType":"module"}